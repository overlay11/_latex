% Предупреждать об устаревших командах
\RequirePackage[l2tabu,orthodox]{nag}

% Класс документа и опции
\providecommand{\documentcls}{extarticle}
\providecommand{\documentmode}{final}
\documentclass[twoside,onecolumn,\documentmode,12pt]{\documentcls}

% Размер страницы и поля
\usepackage[a4paper]{geometry}
\geometry{left=25mm,right=15mm}
\geometry{top=15mm,bottom=20mm}

% Типографская решетка
\usepackage[columns=1]{typogrid}

% Математика
\usepackage{amsmath,amssymb}
% Дополнительные символы
\usepackage[nointegrals]{wasysym}
% Различные пиктограммы
\usepackage{fontawesome5}

% Локализация и шрифты
\usepackage{iftex}
\ifpdftex
    \usepackage[utf8]{inputenc}
    \usepackage[english,russian]{babel}

    % Прописная латиница
    \usepackage{mathrsfs}

    % Первый абзац с красной строки
    \usepackage{indentfirst}
\else
    \usepackage{polyglossia}
    \setdefaultlanguage[indentfirst]{russian}
    \setotherlanguage{english}

    % Шрифты STIX 2 и Paratype
    % https://www.stixfonts.org/
    % https://www.paratype.ru/
    \setmainfont{STIX Two Text}[Ligatures=TeX]
    \setsansfont{PT Sans}[Scale=MatchLowercase]
    \setmonofont{PT Mono}[Scale=0.9]
    \usepackage{unicode-math}
    \setmathfont{STIX Two Math}

    % Прописная латиница
    \setmathfont{STIX Two Math}[range={scr,bfscr},StylisticSet=1]

    \usepackage{xunicode}
    \usepackage{xltxtra}

    % Знак рубля
    \newcommand{\rub}{\symbol{8381}}
\fi

% Колонтитулы
\usepackage{fancyhdr}
\fancyhead{}
\fancyfoot[LO,RE,C]{}
\fancyfoot[RO,LE]{\thepage}
\renewcommand{\headrulewidth}{0pt}
\pagestyle{fancy}
\fancypagestyle{plain}{}

% Залезание строк на поля и висящие строки
\usepackage{ifdraft}
\ifdraft{\fussy}{
    \sloppy
    \usepackage[all]{nowidow}
}

% Микротипографические улучшения текста
\usepackage{microtype}

% Точка после номера в заголовке
\usepackage{secdot}
\sectionpunct{section}{.\space}
\sectionpunct{subsection}{.\space}

% Расстояния между абзацами
\usepackage{nccparskip}

% Оформление теорем
\usepackage[indent]{nccthm}

% Запятая как десятичный разделитель
\usepackage{ncccomma}

% Точки после номеров в содержании
\usepackage[dotinlabels]{titletoc}

% Точка в подписях рисунков и таблиц
\usepackage[labelsep=period]{caption}

% Состав содержания
\usepackage[nottoc,notindex]{tocbibind}

% Предметный указатель
\usepackage{imakeidx}
\makeindex[intoc]

% Рисунки
\usepackage{graphicx,tikz}
\graphicspath{{./}{figures/}}

% Альбомная ориентация рисунков и таблиц
\usepackage{pdflscape}

% Тонкая настройка таблиц
\usepackage{booktabs}

% Многостраничные таблицы
\usepackage{longtable}

% Гиперссылки, допускающие перенос
\usepackage{xurl}
\urlstyle{same}

% Диагональные дроби
\usepackage{xfrac}

% Подчеркивание и перечеркивание текста
\usepackage[normalem]{ulem}

% Гиперссылки и PDF-оглавление
\usepackage[numbered,\documentmode]{bookmark}
\hypersetup{hidelinks}

% Команды для ненумеруемых разделов, включаемых в содержание
\newcommand{\uchapter}[1]{
    \chapter*{#1}
    \addcontentsline{toc}{chapter}{#1}
}
\newcommand{\usection}[1]{
    \section*{#1}
    \addcontentsline{toc}{section}{#1}
}
\newcommand{\usubsection}[1]{
    \subsection*{#1}
    \addcontentsline{toc}{subsection}{#1}
}

% Команда вставки рисунка
\newcommand{\includefigure}[3][]{
    \begin{figure}[htp]
        \centering
        \InputIfFileExists{#3}{}{
            \InputIfFileExists{figures/#3}{}{
                \includegraphics[#1]{#3}
            }
        }
        \caption{#2}
        \label{fig:#3}
    \end{figure}
}

% Команда вставки таблицы
\newcommand{\includetable}[2]{
    \begin{table}[htp]
        \caption{#1}
        \InputIfFileExists{#2}{}{\input{tables/#2}}
    \end{table}
}

% Стиль списка литературы
\bibliographystyle{unsrt}

% Теоремоподобные окружения
\newtheoremtype{definition}{\bfseries}{}{}
\renewtheoremtype{remark}{\bfseries\itshape}{}{}
\AfterTheoremHeaderChar{.}
\AfterTheoremHeaderSkip{\space}
\countstyle{section}
\newtheorem{definition}{Определение}[definition]
\newtheorem{axiom}{Аксиома}[definition]
\newtheorem{example}{Пример}[definition]
\newtheorem{exercise}{Упражнение}[definition]
\newtheorem{theorem}{Теорема}[theorem]
\newtheorem{proposition}[theorem]{Утверждение}[theorem]
\newtheorem{metatheorem}{Метатеорема}[theorem]
\newtheorem{lemma}{Лемма}[theorem]
\newtheorem{remark}{Замечание}[remark]
\ProofStyleParameters{\bfseries\itshape}{Доказательство}

% Знак номера
\providecommand{\No}{\textnumero}

% Сокращения для стрелок
\newcommand{\rarr}{\rightarrow}
\newcommand{\Rarr}{\Rightarrow}
\newcommand{\uarr}{\uparrow}
\newcommand{\Uarr}{\Uparrow}
\newcommand{\larr}{\leftarrow}
\newcommand{\Larr}{\Leftarrow}
\newcommand{\darr}{\downarrow}
\newcommand{\Darr}{\Downarrow}
\newcommand{\lrarr}{\leftrightarrow}
\newcommand{\Lrarr}{\Leftrightarrow}
\newcommand{\rharp}{\rightharpoonup}
\newcommand{\lharp}{\leftharpoondown}
\newcommand{\rlharps}{\rightleftharpoons}

% Комплексная логика
\newcommand{\varneg}{\mathord{\sim}}
\newcommand{\complexrel}[2]{\mathrel{\mathord{#1}\mathord{#2}}}

% Совместимость с pandoc
\newcommand{\tightlist}{\setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% Команды объявления названия и автора документа
\newcommand{\settitle}[1]{
    \title{#1}
    \hypersetup{pdftitle={#1}}
}
\newcommand{\setauthor}[1]{
    \author{#1}
    \hypersetup{pdfauthor={#1}}
}

% Дата выпуска документа
\date{\today}
